<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WorkPlan - M·∫´u T·ªïng h·ª£p</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #e0f2ff; }
    .gradient-box {
      border: 1px solid #ccc;
      min-width: 300px;
      background-color: #e0fce5;
      color: black;
      box-shadow: 0 0 8px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }
    .active-tab {
      background-color: #3b82f6 !important;
      color: white !important;
    }
  </style>
</head>

<body class="min-h-screen text-black">
  <!-- Header c·ªßa trang  -->
    <header class="bg-white shadow-md">
      <div
        class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center"
      >
        <!-- Logo -->
        <div class="text-2xl font-bold text-blue-600">WorkPlan</div>

        <!-- N√∫t menu (hi·ªán khi m√†n nh·ªè) -->
        <button
          id="menuToggle"
          class="md:hidden text-2xl text-gray-700 focus:outline-none"
        >
          ‚ò∞
        </button>

        <!-- Menu ch√≠nh -->
        <nav
          id="navMenu"
          class="hidden md:flex flex-col md:flex-row md:items-center md:space-x-6 text-gray-700 font-medium absolute md:static bg-white md:bg-transparent top-16 left-0 w-full md:w-auto px-4 md:px-0 z-50"
        >
          <a href="index.html" class="py-2 block hover:text-blue-600"
            >Trang ch·ªß</a
          >
          <a href="keHoach.html" class="py-2 block hover:text-blue-600"
            >K·∫ø ho·∫°ch</a
          >
          <a href="nhacNho.html" class="py-2 block hover:text-blue-600"
            >Nh·∫Øc nh·ªü</a
          >
          <a href="dangnhap.html" class="py-2 block hover:text-blue-600"
            >ƒêƒÉng nh·∫≠p</a
          >
          <a href="dangky.html" class="py-2 block hover:text-blue-600"
            >ƒêƒÉng k√Ω</a
          >
        </nav>
      </div>
    </header>
    <!-- End headder  -->
  
  <div class="flex">
    <aside class="w-64 bg-white h-screen p-4 overflow-y-auto shadow">
      <h2 class="text-xl font-bold mb-4">Danh m·ª•c</h2>
      <ul id="menuList" class="space-y-2">
        <li><a href="#" onclick="loadTemplate('mau1', this)" class="block px-3 py-2 rounded editable-tab" data-id="mau1">M·∫´u 1</a></li>
        <li><a href="#" onclick="loadTemplate('mau2', this)" class="block px-3 py-2 rounded editable-tab" data-id="mau2">M·∫´u 2</a></li>
      </ul>
      <button onclick="createNewTemplate()" class="mt-4 w-full text-sm bg-green-500 text-white py-2 rounded hover:bg-green-600">+ Th√™m m·∫´u m·ªõi</button>
    </aside>

    <main class="flex-1 w-full overflow-x-auto">
      <div class="flex justify-between p-4 items-center border-b border-gray-300">
        <h1 id="pageTitle" class="text-2xl font-bold">M·∫´u 1</h1>
        <button onclick="addNewColumn()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm">+ Th√™m ti√™u ƒë·ªÅ</button>
      </div>
      <div id="templateContent" class="flex gap-4 p-4 w-max overflow-x-auto items-start"></div>
    </main>
  </div>

  <div id="formModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden z-50">
    <div class="bg-white text-black rounded p-6 w-full max-w-md">
      <h3 id="formTitle" class="text-xl font-bold mb-4">N·ªôi dung c·∫ßn l√†m</h3>
      <textarea id="formTextarea" rows="5" class="w-full p-2 border rounded mb-4" placeholder="Nh·∫≠p n·ªôi dung..."></textarea>
      <label class="text-sm font-medium block mb-1">Th·ªùi h·∫°n ho√†n th√†nh:</label>
      <div class="flex gap-2 mb-4">
        <input type="datetime-local" id="formDeadline" class="w-full p-2 border rounded">
        <button onclick="clearDeadline()" class="px-3 text-sm text-red-600 border border-red-400 rounded hover:bg-red-100">X√≥a</button>
      </div>
      <div class="flex justify-between">
        <button onclick="deleteCurrentForm()" class="text-red-500 hover:underline">X√≥a m·ª•c</button>
        <div class="space-x-2">
          <button onclick="closeForm()" class="px-4 py-2 bg-gray-300 rounded">H·ªßy</button>
          <button onclick="saveForm()" class="px-4 py-2 bg-blue-600 text-white rounded">L∆∞u</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Footer -->
    <footer class="bg-gray-100 text-gray-600 text-sm mt-10">
      <div
        class="max-w-6xl mx-auto px-4 py-8 flex flex-col md:flex-row justify-between gap-6"
      >
        <!-- C·ªôt 1 -->
        <div class="flex-1">
          <h2 class="font-semibold mb-2">WorkPlan üíº</h2>
          <p>Qu·∫£n l√Ω k·∫ø ho·∫°ch th√¥ng minh, nh·∫Øc nh·ªü ƒë√∫ng l√∫c.</p>
          <p>Made with team</p>
        </div>
        <!-- C·ªôt 2 -->
        <div class="flex-1">
          <h2 class="font-semibold mb-2">Li√™n h·ªá</h2>
          <p>
            Email:
            <a href="mailto:anh@workplan.vn" class="hover:underline"
              >anh@workplan.vn</a
            >
          </p>
          <p>Hotline: 0123 456 789</p>
        </div>
        <!-- C·ªôt 3 -->
        <div class="flex-1">
          <h2 class="font-semibold mb-2">Li√™n k·∫øt</h2>
          <ul class="space-y-1">
            <li><a href="index.html" class="hover:underline">Trang ch·ªß</a></li>
            <li><a href="keHoach.html" class="hover:underline">K·∫ø ho·∫°ch</a></li>
            <li><a href="nhacNho.html" class="hover:underline">Nh·∫Øc nh·ªü</a></li>
          </ul>
        </div>
      </div>

      <!-- D√≤ng d∆∞·ªõi c√πng -->
      <div class="bg-gray-200 py-2 text-center">
        ¬© 2025 WorkPlan. All rights reserved.
      </div>

      <!-- N√∫t cu·ªôn l√™n ƒë·∫ßu -->
      <button
        id="scrollToTopBtn"
        class="fixed bottom-6 right-6 p-3 rounded-full bg-blue-600 text-white shadow-md hover:bg-blue-700 transition-opacity opacity-0 pointer-events-none z-50"
      >
        ‚Üë
      </button>
    </footer>
    <!-- End footer -->    

  <script>
    const btn = document.getElementById("scrollToTopBtn");

      window.addEventListener("scroll", () => {
        if (window.scrollY > 300) {
          btn.classList.remove("opacity-0", "pointer-events-none");
        } else {
          btn.classList.add("opacity-0", "pointer-events-none");
        }
      });

      btn.addEventListener("click", () => {
        window.scrollTo({ top: 0, behavior: "smooth" });
      });

      // X·ª≠ l√≠ khi m√†n h√¨nh nh·ªè th√¨ scale
      const menuToggle = document.getElementById("menuToggle");
      const navMenu = document.getElementById("navMenu");

      menuToggle.addEventListener("click", () => {
        navMenu.classList.toggle("hidden");
      });
    
    let sectionCount = 0;
    let currentSection = '';
    let activeButton = null;
    let currentFormWrapper = null;
    let templateIndex = 3;
    const counters = {};

    const templates = {
      mau1: ["T·ªìn ƒê·ªông", "Chu·∫©n B·ªã N·ªôi Dung", "ƒê√£ ch·ªù xem x√©t", "C·∫ßn Xu·∫•t B·∫£n", "ƒê√£ xu·∫•t b·∫£n"],
      mau2: ["√ù t∆∞·ªüng", "Giao di·ªán", "Ph√°c th·∫£o", "S·∫£n ph·∫©m cu·ªëi", "Xu·∫•t b·∫£n"]
    };

    function loadTemplate(name, el = null) {
      document.getElementById('templateContent').innerHTML = '';
      document.getElementById('pageTitle').textContent = localStorage.getItem(name + '_title') || `M·∫´u ${name.replace('mau', '')}`;
      sectionCount = 0;
      Object.keys(counters).forEach(key => delete counters[key]);
      (templates[name] || []).forEach(title => {
        const id = `section_${sectionCount++}`;
        counters[id] = 0;
        createColumn(id, title);
      });
      document.querySelectorAll('#menuList a').forEach(a => a.classList.remove('active-tab'));
      if (el) el.classList.add('active-tab');
      makeEditableTitle(el, name, true);
    }

    window.onload = () => {
      loadTemplate('mau1', document.querySelector('[data-id="mau1"]'));
    };

    function createNewTemplate() {
      const key = `mau${templateIndex++}`;
      templates[key] = [];
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.href = "#";
      a.className = "block px-3 py-2 rounded hover:bg-blue-200 editable-tab";
      a.textContent = `M·∫´u ${key.replace('mau', '')}`;
      a.dataset.id = key;
      a.onclick = function () { loadTemplate(key, this); };
      makeEditableTitle(a, key, true);
      li.appendChild(a);
      document.getElementById('menuList').appendChild(li);
    }

    function makeEditableTitle(titleElement, key, isTemplate = false) {
      let isEditing = false;
      titleElement.addEventListener('dblclick', () => {
        if (isEditing) return;
        isEditing = true;
        const currentText = titleElement.textContent;
        const input = document.createElement('input');
        input.type = 'text';
        input.value = currentText;
        input.className = 'border p-1 text-sm w-full';
        input.onblur = () => {
          const newTitle = input.value.trim() || currentText;
          const newElem = document.createElement(titleElement.tagName.toLowerCase());
          newElem.textContent = newTitle;
          newElem.className = titleElement.className;
          newElem.dataset.id = titleElement.dataset.id;
          newElem.onclick = titleElement.onclick;
          makeEditableTitle(newElem, key, isTemplate);
          localStorage.setItem(key + '_title', newTitle);
          input.replaceWith(newElem);
        };
        titleElement.replaceWith(input);
        input.focus();
      });
    }

    function createColumn(id, label) {
      const wrapper = document.createElement('div');
      wrapper.className = 'gradient-box rounded p-3';

      const title = document.createElement('div');
      title.className = 'font-bold mb-3 flex justify-between items-center text-lg';
      const span = document.createElement('span');
      span.textContent = label;
      span.className = 'editable-title cursor-pointer';
      makeEditableTitle(span, id);
      title.appendChild(span);

      const delBtn = document.createElement('button');
      delBtn.textContent = '‚úï';
      delBtn.className = 'text-red-500 text-xs ml-2';
      delBtn.onclick = () => wrapper.remove();
      title.appendChild(delBtn);

      const formContainer = document.createElement('div');
      formContainer.id = id;
      formContainer.className = 'space-y-2 flex-1';

      const addBtn = document.createElement('button');
      addBtn.className = 'text-blue-600 hover:underline text-sm mt-2';
      addBtn.textContent = '+ Th√™m m·ª•c';
      addBtn.onclick = () => addForm(id);

      wrapper.appendChild(title);
      wrapper.appendChild(formContainer);
      wrapper.appendChild(addBtn);
      document.getElementById('templateContent').appendChild(wrapper);
    }

    function addNewColumn() {
      const id = `section_${sectionCount++}`;
      counters[id] = 0;
      createColumn(id, `Ti√™u ƒë·ªÅ ${sectionCount}`);
    }

    function addForm(containerId) {
      counters[containerId]++;
      const index = counters[containerId];
      const container = document.getElementById(containerId);

      const wrapper = document.createElement('div');
      wrapper.className = 'flex flex-col gap-1 relative p-1 rounded';
      wrapper.style.backgroundColor = getRandomPastelColor();

      const formId = `${containerId}_form_${index}`;
      const title = document.createElement('span');
      title.textContent = localStorage.getItem(`${formId}_title`) || `M·ª•c ${index}`;
      title.className = 'block font-medium text-left cursor-pointer';
      makeEditableTitle(title, formId);

      const contentBtn = document.createElement('button');
      contentBtn.textContent = localStorage.getItem(`${formId}_deadline`) ?
        `‚è∞ ${new Date(localStorage.getItem(`${formId}_deadline`)).toLocaleString('vi-VN')}` :
        '‚úé Nh·∫≠p n·ªôi dung';
      contentBtn.className = 'text-sm text-blue-600 underline';
      contentBtn.onclick = () => openForm(formId, contentBtn, wrapper);

      wrapper.appendChild(title);
      wrapper.appendChild(contentBtn);
      container.appendChild(wrapper);
    }

    function openForm(formId, button = null, wrapper = null) {
      currentSection = formId;
      activeButton = button;
      currentFormWrapper = wrapper;
      document.getElementById('formTitle').textContent = localStorage.getItem(formId + '_title') || formId;
      document.getElementById('formTextarea').value = localStorage.getItem(formId + '_content') || '';
      document.getElementById('formDeadline').value = localStorage.getItem(formId + '_deadline') || '';
      document.getElementById('formModal').classList.remove('hidden');
    }

    function closeForm() {
      document.getElementById('formModal').classList.add('hidden');
    }

    function saveForm() {
      const content = document.getElementById('formTextarea').value;
      const deadline = document.getElementById('formDeadline').value;
      localStorage.setItem(currentSection + '_content', content);
      localStorage.setItem(currentSection + '_deadline', deadline);
      if (activeButton) {
        activeButton.textContent = deadline ? `‚è∞ ${new Date(deadline).toLocaleString('vi-VN')}` : '‚úé Nh·∫≠p n·ªôi dung';
      }
      closeForm();
    }

    function deleteCurrentForm() {
      if (currentFormWrapper && confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a m·ª•c n√†y?')) {
        currentFormWrapper.remove();
        closeForm();
      }
    }

    function clearDeadline() {
      document.getElementById('formDeadline').value = '';
    }

    function getRandomPastelColor() {
      const hue = Math.floor(Math.random() * 360);
      return `hsl(${hue}, 70%, 90%)`;
    }
  </script>
</body>
</html>
